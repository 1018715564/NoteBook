# 数据库原理及应用

## 第一章 引言

![引言](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509143601.png)

### 数据库系统概述

#### 数据库的四个基本概念

![数据库的四个基本概念](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509105522.png)

1 数据（Data）

* 数据是数据库中存储的基本对象
* 数据的定义：描述事物的符号记录
* 数据的种类：文本、图形、图像、音频、视频、学生的档案记录、货物的运输情况等
* 数据的特点：数据与其语义是不可分的（说明：数据的含义称为数据的语义，数据与其语义是不可分的。）
* 数据举例 1：
  * 例如  93 是一个数据
  * 语义1：学生某门课的成绩
  * 语义2：某人的体重
  * 语义3：某个年级的学生人数
  * 语义n：...
* 数据举例 2：
  * 学生档案中的学生记录（李明，男，197205，江苏南京市，计算机系，1990）
  * 语义：学生姓名、性别、出生年月、籍贯、所在院系、入学时间
  * 解释：李明是个大学生，1972年5月出生，江苏南京市人，1990年考入计算机系

2 数据库（DataBase，简称 DB）

* 数据库的定义：数据库（Database，简称 DB）是长期储存在计算机内、有组织的、可共享的大量数据的集合。（一个大规模集成的数据集合。）
* 数据库的基本特征：
  * 数据按一定的数据模型组织、描述和储存
  * 可为各种用户共享
  * 冗余度较小
  * 数据独立性较高
  * 易扩展
* 数据库作用：
  * 一个数据库是对现实生活中一个企业或一个单位在计算机中的建模结果
    - 实体
    - 联系（实体间的关系）

3 数据库管理系统（DataBase Management System，简称 DBMS）

* DBMS 的定义：是位于用户与操作系统之间的一层数据管理软件。数据库管理系统和操作系统一样是计算机的基础软件，也是一个大型复杂的软件系统。 
* DBMS 的用途：数据库管理系统的主要任务就是科学地组织和存储数据、高效地获取和维护数据
* DBMS 的主要功能
  * **数据定义功能**
    * 提供数据定义语言（DDL）
    * 定义数据库中的数据对象
  * **数据组织、存储和管理**
    * 分类组织、存储和管理各种数据       
    * 确定组织数据的文件结构和存取方式
    * 实现数据之间的联系
    * 提供多种存取方法提高存取效率
  * **数据操纵功能**
    * 提供数据操纵语言（DML）
    * 实现对数据库的基本操作 CRUD  (查询、插入、删除和修改)
  * **数据库的事务管理和运行管理**
    * 数据库在建立、运行和维护时由 DBMS 统一管理和控制，保证事务的正确性
    * 保证数据的安全性、完整性、多用户对数据的并发使用
    * 发生故障后的系统恢复
  * **数据库的建立和维护功能（实用程序）**
    * 数据库初始数据装载转换	
    * 数据库转储
    * 介质故障恢复
    * 数据库的重组织
    * 性能监视分析等
  * **其它功能**
    * DBMS 与网络中其它软件系统的通信
    * 两个 DBMS 系统的数据转换
    * 异构数据库之间的互访和互操作

4 数据库系统（Database System，简称 DBS）

* 数据库系统的定义：在计算机系统中引入数据库后的系统构成数据库系统。
* 数据库系统的构成
  * 数据库
  * 数据库管理系统（及其开发工具）
  * 应用系统
  * 数据库管理员  (DBA)：是负责数据库的设计、规划、协调的专职人员。是全面负责建立、维护和管理数据库系统的人员。

![数据库系统层次结构](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509110354.png)

下面附一张各种人员的数据视图，知道即可：

![各种人员的数据视图](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509144002.png)

#### 数据管理技术的产生和发展

1 什么是数据管理

数据管理是对数据进行分类、组织、编码、存储、检索和维护，也是数据处理的中心问题。

2 数据管理技术的发展过程

* 人工管理阶段（20 世纪 40 年代中 —— 50 年代中）
* 文件系统阶段（20 世纪 50 年代末 —— 60 年代中）
* 数据库系统阶段（20 世纪 60 年代末 —— 现在）

#### 数据库系统的特点

* **数据结构化**

  * 数据库的主要特征之一，也是数据库系统与文件系统的本质区别

* **数据的共享性高，冗余度低，易扩充**

  * 数据共享的好处：
    * 减少数据冗余，节约存储空间
    * 避免数据之间的不相容性与不一致性 
    * 使系统易于扩充

* **数据独立性高**

  * 物理独立性：指用户的应用程序与存储在磁盘上的数据库中数据是相互独立的。当数据的物理存储改变了，应用程序不用改变。
  * 逻辑独立性：指用户的应用程序与数据库的逻辑结构是相互独立的。数据的逻辑结构改变了，用户程序也可以不变。
  * 数据独立性是由 DBMS 的二级映像功能来保证的

* **数据由 DBMS 统一管理和控制**

  DBMS 提供以下几方面的数据控制功能

  - 数据的安全性（Security）保护：保护数据，以防止不合法的使用造成的数据的泄密和破坏。
  - 数据的完整性（Integrity）检查：将数据控制在有效的范围内，或保证数据之间满足一定的关系。
  - 并发（Concurrency）控制：对多用户的并发操作加以控制和协调，防止相互干扰而得到错误的结果。
  - 数据库恢复（Recovery）：DBMS 必须具有将数据库从错误状态恢复到某一正确状态的功能

> 数据库系统阶段应用程序与数据的对应关系（数据库系统）

![应用程序与数据的对应关系](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509115702.png)

### 数据模型

在数据库中使用**数据模型**这个工具来抽象、表示和处理现实世界中的数据和信息，通俗地来讲，**数据模型就是现实世界的模拟**。

数据模型应满足三方面要求：

* 能比较真实地模拟现实世界
* 容易为人所理解
* 便于在计算机上实现

#### 两类数据模型

数据模型分为两类（分属两个不同的层次）

##### ① 概念模型

概念模型，也称信息模型，它是按用户的观点来对数据和信息建模，用于数据库设计。

![现实世界中客观对象的抽象过程](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509121142.png)

涉及的概念：

- **实体（Entity）：**客观存在并可相互区别的事物，比如一个学生，一门课，学生的一次选课
- **属性（Attribute）：**实体所具有的某一特性，比如学生的身高，一个实体可以由若干个属性来刻画。
- **码（Key） ：**唯一标识实体的属性集，比如学生的学号
- **域（Domain）：**属性的取值范围称为该属性的域。
- **实体型（Entity Type）：** 实体名 + 属性名，比如 学生（学号，姓名，性别）就是一个实体型
- **实体集（Entity Set）：**同一类型的实体的集合，比如全体学生
- **联系（Relationship） ：**现实世界中事物内部以及事物之间的联系在信息中反映为实体内部的联系和实体之间的联系。
  - 实体内部的联系通常是指组成实体的各属性之间的联系
  - 实体之间的联系通常是指不同实体集之间的联系，（有一对一，一对多，多对多等多种类型），**实体之间的联系可用 E - R 图 表示**

一个实例：

**用 E - R 图表示某个工厂物资管理的概念模型**

* 实体：
  * 仓库： 仓库号、面积、电话号码
  * 零件 ：零件号、名称、规格、单价、描述
  * 供应商：供应商号、姓名、地址、电话号码、帐号
  * 项目：项目号、预算、开工日期
  * 职工：职工号、姓名、年龄、职称    
* 完整的 E - R 图

![完整的 E - R 图](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509122826.png)



##### ② 逻辑模型和物理模型

逻辑模型主要包括网状模型、层次模型、关系模型、面向对象模型等，按计算机系统的观点对数据建模，用于 DBMS 实现。

物理模型是对数据最底层的抽象，描述数据在系统内部的表示方式和存取方法，在磁盘或磁带上的存储方式和存取方法。

* 层次模型：层次模型用树形结构来表示各类实体以及实体间的联系。

  满足下面两个条件的基本层次联系的集合为层次模型：

  * 有且只有一个结点没有双亲结点，这个结点称为根结点
  * 根以外的其它结点有且只有一个双亲结点

* 网状模型

  满足下面两个条件的基本层次联系的集合为网状模型：

  * 允许一个以上的结点无双亲
  * 一个结点可以有多于一个的双亲

* **关系模型**：关系数据库系统采用关系模型作为数据的组织方式

* 面向对象数据模型

* 对象关系数据模型

* 半结构化数据模型

> 由于计算机厂商新推出的数据库管理系统几乎都支持关系模型，所以下面重点来说说关系模型！

#### 关系模型

关系模型是最重要的一种数据模型。

在用户观点下，关系模型由一组关系组成，每个关系的数据结构是一张规范化的二维表，它由行（元组）和列（属性）组成。

![关系表](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509123934.png)

关系模型相关的术语：

- 关系（Relation）：一个关系对应一张表
- 元组（Tuple）：表中的一行即一个元组
- 属性（Attribute）：表中的一列即一个属性，给每一个属性起一个名称即属性名
- 主码（Key） ：表中的某个属性组，可以唯一确定一个元组，该属性组就称为主码。比如上表中的学号就就是该关系的主码
- 域（Domain）：域是一组具有相同数据类型的值的集合。比如人的年龄是1-120岁，属性的取值范围来自该属性对应的域
- 分量：元组中的一个属性值。
- 关系模式：对关系的描述，一般表示为 关系名（属性名1，属性名2....）。比如学生（学号，姓名，年龄，性别，系，年级）。关系模式必须是规范化的，不允许表中还有表，每个属性都应该是不可分的（即关系的每一个分量必须是一个不可分的数据项）

### 数据库系统结构

* 从**数据库最终用户角度**看（数据库系统外部的体系结构） ，数据库系统的结构分为：
  * 单用户结构
  * 主从式结构
  * 客户／服务器
  * 浏览器／应用服务器／数据库服务器多层结构等
* 从**数据库管理系统角度**看，数据库系统通常采用三级模式结构，是数据库系统内部的系统结构 

#### 数据库系统模式的概念

1 型和值的概念

* 型（Type）：对某一类数据的结构和属性的说明
* 值（Value）：是型的一个具体赋值

举例：

学生记录型：（学号，姓名，性别，系别，年龄，籍贯）

一个记录值：（900201，李明，男，计算机，22，江苏

2 模式（Schema）

* 数据库逻辑结构和特征的描述
* 是型的描述
* 反映的是数据的结构及其联系
* 模式是相对稳定的

3 实例（Instance）

* 模式的一个具体值
* 反映数据库某一时刻的状态
* 同一个模式可以有很多实例
* 实例随数据库中的数据的更新而变动



#### 数据库系统的三级模式结构

![数据库系统的三级模式结构](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509141539.png)

##### 1 模式（Schema）

模式（也称逻辑模式）：数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图，综合了所有用户的需求

注：一个数据库只有一个模式，模式的地位是数据库系统模式结构的中间层，与数据的物理存储细节和硬件环境无关，与具体的应用程序、开发工具及高级程序设计语言无关

##### 2 外模式（External Schema）

外模式（也称子模式或用户模式）：是数据库用户（包括应用程序员和最终用户）使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示

注：外模式的地位：介于模式与应用之间

模式与外模式的关系：一对多

* 外模式通常是模式的子集
* **一个数据库可以有多个外模式**。反映了不同的用户的应用需求、看待数据的方式、对数据保密的要求
* 对模式中同一数据，在外模式中的结构、类型、长度、保密级别等都可以不同

外模式与应用的关系：一对多

* 同一外模式也可以为某一用户的多个应用系统所使用
* 但一个应用程序只能使用一个外模式

> 外模式是保证数据库安全的一个有力措施。每个用户只能看见和访问对应的外模式中的数据，数据库的其余数据是不可见的。

##### 3 内模式（Internal Schema） 

内模式（也称存储模式）：是数据物理结构和存储方式的描述，是数据在数据库内部的表示方式。

注：一个数据库只有一个内模式

!> 数据在数据库内部的表示方式:

* 记录的存储方式（顺序存储，按照B树结构存储，
     按hash方法存储）
* 索引的组织方式
* 数据是否压缩存储
* 数据是否加密
* 数据存储记录结构的规定

> 最后再来回顾一下数据库系统的三级模式结构：

![数据库系统的三级模式结构](https://gitee.com/wugenqiang/PictureBed/raw/master/NoteBook/20200509142722.png)



#### 数据库的二级映像功能与数据独立性

* 三级模式是对数据的三个抽象级别
* 二级映象在 DBMS 内部实现这三个抽象层次的联系和转换
  * 外模式／模式映像
  * 模式／内模式映像



## 参考资料

[1] 东南大学 - 徐立臻 - 数据库原理及应用（[:seedling: 视频学习入口](https://www.bilibili.com/video/BV1ux411G7Bs)）

[2] 小牛肉的 wiki（[:seedling: 链接地址](https://veal98.github.io/CS-Wiki/#/README?id=📘-数据库)）

